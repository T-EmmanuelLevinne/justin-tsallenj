<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>goodluck.... </title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Roboto:wght@900&display=swap');

        body {
            height: 100vh;
            margin: 0px;
            display: flex;
            align-items: center;
            justify-content: center;
            background-color: #000;
            overflow: hidden;
        }

        #start-button {
            padding: 2vh 5vh;
            border-radius: 4vh;
            position: absolute;
            background-color: #f00;
            font-size: 10vh;
            font-family: Roboto, Arial, sans-serif;
            cursor: pointer;
            transition: scale .2s ease, background-color .2s ease, translate .3s ease-in-out;
            user-select: none;
        }
        #start-button:hover {
            scale: 1.1;
            background-color: #ff0;
        }
        #start-button:active {
            scale: .95;
        }
        #start-button.hidden {
            translate: 0px 60vh;
        }

        .container {
            width: 40vh;
            height: 80vh;
            position: absolute;
            display: flex;
            flex-wrap: wrap;
            transition: opacity 1s ease, scale 1s ease-in-out;
        }
        .container.hidden {
            opacity: 0;
            scale: 1.5;
        }

        .rotary-container:not(.hidden) {
            transition: opacity 1.3s ease;
        }
        .rotary-container.hidden {
            opacity: 0;
        }

        .key {
            width: 20vh;
            height: 20vh;
            --col: #f00;
            color: var(--col);
            text-shadow: 0px 0px 8vh var(--col);
            transition: color .3s ease, text-shadow .3s ease;
            font-size: 16vh;
            font-family: Roboto, Arial, sans-serif;
            font-weight: 900;
            display: flex;
            align-items: center;
            justify-content: center;
            user-select: none;
            cursor: pointer;
        }
        .rotary-container > .key {
            position: absolute;
            left: calc(20vmin * var(--x) - 10vh);
            top: calc(20vmin * var(--y) - 10vh);
        }
        .rotary-container > .key:nth-child(1) {
            --x: 0.707;
            --y: -0.707;
        }
        .rotary-container > .key:nth-child(2) {
            --x: 0;
            --y: -1;
        }
        .rotary-container > .key:nth-child(3) {
            --x: -0.707;
            --y: -0.707;
        }
        .rotary-container > .key:nth-child(4) {
            --x: -1;
            --y: 0;
        }
        .rotary-container > .key:nth-child(5) {
            --x: -0.707;
            --y: 0.707;
        }
        .rotary-container > .key:nth-child(6) {
            --x: 0;
            --y: 1;
        }
        .rotary-container > .key:nth-child(7) {
            --x: 0.707;
            --y: 0.707;
        }
        .rotary-container > .key:nth-child(8) {
            --x: 1;
            --y: 0;
        }

        #wrong, #correct {
            position: absolute;
            opacity: 0;
            font-size: 18vw;
            cursor: default;
            color: white;
            font-weight: 900;
            z-index: 10001;
        }

        @media (max-width: 768px) {
            .key {
                font-size: 12vh;
            }
            #start-button {
                font-size: 8vh;
                padding: 1.5vh 4vh;
            }
            #wrong, #correct {
                font-size: 15vw;
            }
        }
    </style>
</head>
<body>
    <div class="container hidden">
        <div class="key">&gt;</div>
        <div class="key">&gt;</div>
        <div class="key">&gt;</div>
        <div class="key">&gt;</div>
        <div class="key">&gt;</div>
        <div class="key">&gt;</div>
        <div class="key">&gt;</div>
        <div class="key">&gt;</div>
    </div>
    <div id="wrong">MOSQUEDA MANKA</div>
    <div id="correct">TAMA</div>
    <div id="start-button">START</div>
    
    <!-- Background Music -->
    <audio id="background-music" autoplay muted>
        <source src="background-music.mp3" type="audio/mpeg">
        Your browser does not support the audio element.
    </audio>

    <script>
        const startBtn = document.getElementById('start-button');
        const container = document.getElementsByClassName('container')[0];
        const keys = document.getElementsByClassName('key');
        const wrong = document.getElementById('wrong');
        const correct = document.getElementById('correct');
        const movements = [
            [[1, 0], [0, 1], [0, -1], [-1, 0], [1, 0], [0, 1], [0, -1], [-1, 0]],     // small rotate cw, cw
            [[1, 0], [0, 1], [0, -1], [-1, 0], [0, 1], [-1, 0], [1, 0], [0, -1]],     // small rotate cw, ccw
            [[0, 1], [-1, 0], [1, 0], [0, -1], [1, 0], [0, 1], [0, -1], [-1, 0]],     // small rotate ccw,cw
            [[0, 1], [-1, 0], [1, 0], [0, -1], [0, 1], [-1, 0], [1, 0], [0, -1]],     // small rotate ccw,ccw
            [[1, 0], [0, 1], [0, -1], [0, 1], [0, -1], [0, 1], [0, -1], [-1, 0]],     // big rotate cw
            [[0, 1], [-1, 0], [0, 1], [0, -1], [0, 1], [0, -1], [1, 0], [0, -1]],     // big rotate ccw
            [[1, 3], [-1, 3], [0, -1], [0, -1], [0, -1], [0, -1], [0, -1], [0, -1]],  // top to bottom swap
            [[0, 1], [0, 1], [0, 1], [0, 1], [0, 1], [0, 1], [1, -3], [-1, -3]],      // bottom to top swap
            [[1, 0], [-1, 0], [1, 0], [-1, 0], [1, 0], [-1, 0], [1, 0], [-1, 0]],     // horizontal swap
            [[1, 1], [-1, 1], [1, -1], [-1, -1], [1, 1], [-1, 1], [1, -1], [-1, -1]], // small diagonal swap
            [[1, 1], [0, 0], [1, 1], [-1, -1], [1, 1], [-1, -1], [0, 0], [-1, -1]],   // big diagonal swap tl/br
            [[0, 0], [-1, 1], [1, -1], [-1, 1], [1, -1], [-1, 1], [1, -1], [0, 0]]    // big diagonal swap bl/tr
        ];
        const doMove = [true, true, true, true, true, false, false, true, true, true, false, false, true, true, true, true, true, true, true, true, false, false, true, true, true, true, true, true, true, false];
        
        let correctKey = 0;
        let gameCompleted = false;
        let blinkInterval;

        // Play background music automatically
        const backgroundMusic = document.getElementById('background-music');
        backgroundMusic.volume = 0.7; // Set volume to 70%
        backgroundMusic.muted = false; // Unmute the audio
        
        // Force play immediately
        backgroundMusic.play();
        
        // Also try when page loads
        window.addEventListener('load', () => {
            backgroundMusic.currentTime = 0;
            backgroundMusic.muted = false;
            backgroundMusic.play();
        });

        // Start the game immediately
        startBtn.classList.add('hidden');
        window.setTimeout(() => {
            container.classList.remove('hidden');
            window.setTimeout(() => {
                correctKey = Math.floor(Math.random() * 8);
                keys[correctKey].style.setProperty('--col', '#0f0');
                window.setTimeout(() => {
                    keys[correctKey].style.setProperty('--col', '#f00');
                    window.setTimeout(() => {
                        let i = 0
                        let moveInterval = window.setInterval(() => {
                            if(doMove[i]) {
                                let movement = movements[Math.floor(Math.random() * movements.length)];
                                for(let j = 0; j < 8; j++) {
                                    if(movement[j][0] !== 0 || movement[j][1] !== 0) {
                                        keys[j].animate([{translate: '0px 0px'}, {translate: `${movement[j][0] * 20}vh ${movement[j][1] * 20}vh`}],
                                                       {duration: 270, easing: 'ease-in-out'});
                                    }
                                }
                                correctKey += movement[correctKey][0] + movement[correctKey][1] * 2;
                                correctKey = ((correctKey % 8) + 8) % 8; // Ensure it stays within 0-7
                            }
                            else if(i === 5) {
                                for(let j = 0; j < 4; j++) {
                                    keys[j].animate([{translate: '0px 0px'}, {translate: '0px 40vh'}],
                                                   {duration: 540, easing: 'ease-in-out'});
                                }
                                for(let j = 4; j < 8; j++) {
                                    keys[j].animate([{translate: '0px 0px'}, {translate: '-30vh -20vh'}, {translate: '0px -40vh'}],
                                                   {duration: 540, easing: 'ease-in-out'});
                                }
                                correctKey = (correctKey + 4) % 8
                            }
                            else if(i === 10) {
                                container.animate([{rotate: '0deg'}, {rotate: '180deg'}],
                                               {duration: 540, easing: 'ease-in-out', fill: 'forwards'});
                            }
                            else if(i === 20) {
                                container.animate([{rotate: '-180deg'}, {rotate: '0deg'}],
                                               {duration: 540, easing: 'ease-in-out', fill: 'forwards'});
                            }
                            i++;
                            if(i === 30) {
                                window.clearInterval(moveInterval);
                                let colors = ['#f00', '#ff0', '#0f0', '#0ff', '#00f', '#80f', '#f08', '#f70'].sort(() => Math.random() - .5);
                                let j = 0;
                                let colorInterval = window.setInterval(() => {
                                    keys[j].animate([{rotate: '0deg'}, {rotate: '360deg'}],
                                                   {duration: 1000, easing: 'cubic-bezier(.2, .3, 0, 1)'});
                                    keys[j].style.setProperty('--col', colors[j]);
                                    j++;
                                    if(j === 8) {
                                        window.clearInterval(colorInterval);
                                        window.setTimeout(() => {
                                            container.classList.add('hidden');
                                            window.setTimeout(() => {
                                                container.className = 'rotary-container';
                                                container.animate([{rotate: '0deg'}, {rotate: '360deg'}],
                                                                 {duration: 15000, iterations: Infinity});
                                                for(let k = 0; k < 8; k++) {
                                                    keys[k].animate([{rotate: '0deg'}, {rotate: '-360deg'}],
                                                                 {duration: 15000, iterations: Infinity});
                                                }
                                                let k = -1;
                                                blinkInterval = window.setInterval(() => {
                                                    k = (k + 1) % 8;
                                                    keys[k].animate([{textShadow: '0px 0px 8vh var(--col), 0px 0px 8vh #fffd', color: '#fff'}, {textShadow: '0px 0px 8vh var(--col)', color: 'var(--col)'}],
                                                                   {duration: 500});
                                                }, 500);
                                                
                                                document.body.onclick = () => {
                                                    document.body.onclick = () => null;
                                                    window.clearInterval(blinkInterval);
                                                    let containerAnims = container.getAnimations();
                                                    for(let l = 0; l < containerAnims.length; l++) {
                                                        containerAnims[l].cancel();
                                                    }
                                                    container.classList.add('hidden');
                                                    document.body.animate([{backgroundColor: keys[k].style.getPropertyValue('--col')}, {backgroundColor: '#000'}],
                                                                         {duration: 1000});
                                                    window.setTimeout(() => {
                                                        let text = (k === correctKey) ? correct : wrong;
                                                        text.style.color = keys[correctKey].style.getPropertyValue('--col');
                                                        text.animate([{opacity: 1}, {opacity: 0}],
                                                                    {duration: 2000});
                                                        container.classList.remove('rotary-container');
                                                        container.classList.add('container');
                                                        for(let l = 0; l < 8; l++) {
                                                            keys[l].getAnimations()[0].cancel();
                                                            keys[l].style.setProperty('--col', '#f00');
                                                        }
                                                        window.setTimeout(() => {
                                                            // Check if correct and redirect
                                                            if (k === correctKey) {
                                                                // Correct answer - redirect to congrats.html
                                                                window.location.href = 'congrats.html';
                                                            } else {
                                                                // Wrong answer - redirect to index.html
                                                                window.location.href = 'index.html';
                                                            }
                                                        }, 2000);
                                                    }, 3000);
                                                }
                                            }, 1000);
                                        }, 500);
                                    }
                                }, 50);
                            }
                        }, 270);
                    }, 500);
                }, 500);
            }, 1000);
        }, 200);
    </script>
</body>
</html>